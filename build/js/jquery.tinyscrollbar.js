!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):t(jQuery)}(function(t){"use strict";function o(o,n){function s(){return d.contentPosition>0}function h(){return d.contentPosition<=d.contentSize-d.viewportSize-5}function c(o,i){d.hasContentToSroll&&(t("body").addClass("noSelect"),k=i?f.offset()[P]:b?o.pageX:o.pageY,w&&(document.ontouchmove=function(t){(d.options.touchLock||s()&&h())&&t.preventDefault(),t.touches[0][e+"Touch"]=1,a(t.touches[0])},document.ontouchend=r),t(document).bind("mousemove",a),t(document).bind("mouseup",r),f.bind("mouseup",r),S.bind("mouseup",r),a(o))}function u(e){if(d.hasContentToSroll){var i=e||window.event,n=-(i.deltaY||i.detail||-1/3*i.wheelDelta)/40,c=1===i.deltaMode?d.options.wheelSpeed:1;d.contentPosition-=n*c*d.options.wheelSpeed,d.contentPosition=Math.min(d.contentSize-d.viewportSize,Math.max(0,d.contentPosition)),d.thumbPosition=d.contentPosition/d.trackRatio,o.trigger("move"),f.css(P,d.thumbPosition),l.css(P,-d.contentPosition),(d.options.wheelLock||s()&&h())&&(i=t.event.fix(i)).preventDefault()}e.stopPropagation()}function a(t){if(d.hasContentToSroll){var i=b?t.pageX:t.pageY,n=t[e+"Touch"]?k-i:i-k,s=Math.min(d.trackSize-d.thumbSize,Math.max(0,d.thumbPosition+n));d.contentPosition=s*d.trackRatio,o.trigger("move"),f.css(P,s),l.css(P,-d.contentPosition)}}function r(){d.thumbPosition=parseInt(f.css(P),10)||0,t("body").removeClass("noSelect"),t(document).unbind("mousemove",a),t(document).unbind("mouseup",r),f.unbind("mouseup",r),S.unbind("mouseup",r),document.ontouchmove=document.ontouchend=null}this.options=t.extend({},i,n),this._defaults=i,this._name=e;var d=this,m=o.find(".viewport"),l=o.find(".overview"),p=o.find(".scrollbar"),S=p.find(".track"),f=p.find(".thumb"),w="ontouchstart"in document.documentElement,z="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",b="x"===this.options.axis,v=b?"width":"height",P=b?"left":"top",k=0;return this.contentPosition=0,this.viewportSize=0,this.contentSize=0,this.contentRatio=0,this.trackSize=0,this.trackRatio=0,this.thumbSize=0,this.thumbPosition=0,this.hasContentToSroll=!1,this.update=function(t){var o=v.charAt(0).toUpperCase()+v.slice(1).toLowerCase();switch(this.viewportSize=m[0]["offset"+o],this.contentSize=l[0]["scroll"+o],this.contentRatio=this.viewportSize/this.contentSize,this.trackSize=this.options.trackSize||this.viewportSize,this.thumbSize=Math.min(this.trackSize,Math.max(this.options.thumbSizeMin,this.options.thumbSize||this.trackSize*this.contentRatio),1),this.trackRatio=(this.contentSize-this.viewportSize)/(this.trackSize-this.thumbSize),this.hasContentToSroll=this.contentRatio<1,p.toggleClass("disable",!this.hasContentToSroll),t){case"bottom":this.contentPosition=Math.max(this.contentSize-this.viewportSize,0);break;case"relative":this.contentPosition=Math.min(Math.max(this.contentSize-this.viewportSize,0),Math.max(0,this.contentPosition));break;default:this.contentPosition=parseInt(t,10)||0}return this.thumbPosition=this.contentPosition/this.trackRatio,f.css(P,d.thumbPosition),l.css(P,-d.contentPosition),p.css(v,d.trackSize),S.css(v,d.trackSize),f.css(v,d.thumbSize),d},d.update(),w&&(m[0].ontouchstart=function(t){1===t.touches.length&&(t.stopPropagation(),c(t.touches[0]))}),f.bind("mousedown",function(t){t.stopPropagation(),c(t)}),S.bind("mousedown",function(t){c(t,!0)}),t(window).resize(function(){d.update("relative")}),d.options.wheel&&window.addEventListener?o[0].addEventListener(z,u,!1):d.options.wheel&&(o[0].onmousewheel=u),d}var e="tinyscrollbar",i={axis:"y",wheel:!0,wheelSpeed:40,wheelLock:!0,touchLock:!0,trackSize:!1,thumbSize:!1,thumbSizeMin:20};t.fn[e]=function(i){return this.each(function(){t.data(this,"plugin_"+e)||t.data(this,"plugin_"+e,new o(t(this),i))})}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpxdWVyeS50aW55c2Nyb2xsYmFyLmpzIl0sIm5hbWVzIjpbImZhY3RvcnkiLCJkZWZpbmUiLCJhbWQiLCJleHBvcnRzIiwibW9kdWxlIiwicmVxdWlyZSIsImpRdWVyeSIsIiQiLCJQbHVnaW4iLCIkY29udGFpbmVyIiwib3B0aW9ucyIsIl9pc0F0QmVnaW4iLCJzZWxmIiwiY29udGVudFBvc2l0aW9uIiwiX2lzQXRFbmQiLCJjb250ZW50U2l6ZSIsInZpZXdwb3J0U2l6ZSIsIl9zdGFydCIsImV2ZW50IiwiZ290b01vdXNlIiwiaGFzQ29udGVudFRvU3JvbGwiLCJhZGRDbGFzcyIsIm1vdXNlUG9zaXRpb24iLCIkdGh1bWIiLCJvZmZzZXQiLCJwb3NpTGFiZWwiLCJpc0hvcml6b250YWwiLCJwYWdlWCIsInBhZ2VZIiwiaGFzVG91Y2hFdmVudHMiLCJkb2N1bWVudCIsIm9udG91Y2htb3ZlIiwidG91Y2hMb2NrIiwicHJldmVudERlZmF1bHQiLCJ0b3VjaGVzIiwicGx1Z2luTmFtZSIsIl9kcmFnIiwib250b3VjaGVuZCIsIl9lbmQiLCJiaW5kIiwiJHRyYWNrIiwiX3doZWVsIiwiZXZudE9iaiIsIndpbmRvdyIsIndoZWVsRGVsdGEiLCJkZWx0YVkiLCJkZXRhaWwiLCJtdWx0aXBseSIsImRlbHRhTW9kZSIsIndoZWVsU3BlZWQiLCJNYXRoIiwibWluIiwibWF4IiwidGh1bWJQb3NpdGlvbiIsInRyYWNrUmF0aW8iLCJ0cmlnZ2VyIiwiY3NzIiwiJG92ZXJ2aWV3Iiwid2hlZWxMb2NrIiwiZml4Iiwic3RvcFByb3BhZ2F0aW9uIiwibW91c2VQb3NpdGlvbk5ldyIsInRodW1iUG9zaXRpb25EZWx0YSIsInRodW1iUG9zaXRpb25OZXciLCJ0cmFja1NpemUiLCJ0aHVtYlNpemUiLCJwYXJzZUludCIsInJlbW92ZUNsYXNzIiwidW5iaW5kIiwidGhpcyIsImV4dGVuZCIsImRlZmF1bHRzIiwiX2RlZmF1bHRzIiwiX25hbWUiLCIkdmlld3BvcnQiLCJmaW5kIiwiJHNjcm9sbGJhciIsImRvY3VtZW50RWxlbWVudCIsIndoZWVsRXZlbnQiLCJjcmVhdGVFbGVtZW50IiwidW5kZWZpbmVkIiwib25tb3VzZXdoZWVsIiwiYXhpcyIsInNpemVMYWJlbCIsImNvbnRlbnRSYXRpbyIsInVwZGF0ZSIsInNjcm9sbFRvIiwic2l6ZUxhYmVsQ2FwIiwiY2hhckF0IiwidG9VcHBlckNhc2UiLCJzbGljZSIsInRvTG93ZXJDYXNlIiwidGh1bWJTaXplTWluIiwidG9nZ2xlQ2xhc3MiLCJvbnRvdWNoc3RhcnQiLCJsZW5ndGgiLCJyZXNpemUiLCJ3aGVlbCIsImFkZEV2ZW50TGlzdGVuZXIiLCJmbiIsImVhY2giLCJkYXRhIl0sIm1hcHBpbmdzIjoiQ0FBRSxTQUFTQSxHQUNlLG1CQUFYQyxRQUF5QkEsT0FBT0MsSUFDdkNELFFBQVEsVUFBV0QsR0FFSyxpQkFBWkcsUUFDWkMsT0FBT0QsUUFBVUgsRUFBUUssUUFBUSxXQUdqQ0wsRUFBUU0sUUFSZixDQVdBLFNBQVNDLEdBQ04sYUFlQSxTQUFTQyxFQUFPQyxFQUFZQyxHQXdOeEIsU0FBU0MsSUFDTCxPQUFPQyxFQUFLQyxnQkFBa0IsRUFPbEMsU0FBU0MsSUFDTCxPQUFPRixFQUFLQyxpQkFBb0JELEVBQUtHLFlBQWNILEVBQUtJLGFBQWdCLEVBTzVFLFNBQVNDLEVBQU9DLEVBQU9DLEdBQ2hCUCxFQUFLUSxvQkFDSmIsRUFBRSxRQUFRYyxTQUFTLFlBRW5CQyxFQUFnQkgsRUFBWUksRUFBT0MsU0FBU0MsR0FBY0MsRUFBZVIsRUFBTVMsTUFBUVQsRUFBTVUsTUFFMUZDLElBQ0NDLFNBQVNDLFlBQWMsU0FBU2IsSUFDekJOLEVBQUtGLFFBQVFzQixXQUFhckIsS0FBZ0JHLE1BQ3pDSSxFQUFNZSxpQkFFVmYsRUFBTWdCLFFBQVEsR0FBR0MsRUFBYSxTQUFXLEVBQ3pDQyxFQUFNbEIsRUFBTWdCLFFBQVEsS0FFeEJKLFNBQVNPLFdBQWFDLEdBRTFCL0IsRUFBRXVCLFVBQVVTLEtBQUssWUFBYUgsR0FDOUI3QixFQUFFdUIs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LEdBQVliLEVBQUtDLGlCQUMvQitELEVBQVdwQixJQUFJMkIsRUFBV3ZFLEVBQUtvRCxXQUMvQnhCLEVBQU9nQixJQUFJMkIsRUFBV3ZFLEVBQUtvRCxXQUMzQnpDLEVBQU9pQyxJQUFJMkIsRUFBV3ZFLEVBQUtxRCxXQVpwQnJELEdBMUNQQSxFQUFLeUUsU0E4REZ4RCxJQUNDNkMsRUFBVSxHQUFHb0IsYUFBZSxTQUFTNUUsR0FDOUIsSUFBTUEsRUFBTWdCLFFBQVE2RCxTQUNuQjdFLEVBQU0wQyxrQkFFTjNDLEVBQU9DLEVBQU1nQixRQUFRLE9BSWpDWCxFQUFPZ0IsS0FBSyxZQUFhLFNBQVNyQixHQUM5QkEsRUFBTTBDLGtCQUNOM0MsRUFBT0MsS0FFWHNCLEVBQU9ELEtBQUssWUFBYSxTQUFTckIsR0FDOUJELEVBQU9DLEdBQU8sS0FHbEJYLEVBQUVvQyxRQUFRcUQsT0FBTyxXQUNicEYsRUFBS3lFLE9BQU8sY0FHYnpFLEVBQUtGLFFBQVF1RixPQUFTdEQsT0FBT3VELGlCQUM1QnpGLEVBQVcsR0FBR3lGLGlCQUFpQnBCLEVBQVlyQyxHQUFRLEdBRS9DN0IsRUFBS0YsUUFBUXVGLFFBQ2pCeEYsRUFBVyxHQUFHd0UsYUFBZXhDLEdBcEYxQjdCLEVBeklmLElBQUl1QixFQUFhLGdCQUNib0MsR0FDSVcsS0FBTyxJQUNQZSxPQUFRLEVBQ1JoRCxXQUFhLEdBQ2JTLFdBQVksRUFDWjFCLFdBQVksRUFDWmdDLFdBQVksRUFDWkMsV0FBWSxFQUNaMkIsYUFBZSxJQTRWdkJyRixFQUFFNEYsR0FBR2hFLEdBQWMsU0FBU3pCLEdBQ3hCLE9BQU8yRCxLQUFLK0IsS0FBSyxXQUNUN0YsRUFBRThGLEtBQUtoQyxLQUFNLFVBQVlsQyxJQUN6QjVCLEVBQUU4RixLQUFLaEMsS0FBTSxVQUFZbEMsRUFBWSxJQUFJM0IsRUFBT0QsRUFBRThELE1BQU8zRCIsImZpbGUiOiJqcXVlcnkudGlueXNjcm9sbGJhci5qcyIsInNvdXJjZXNDb250ZW50IjpbIjsoZnVuY3Rpb24oZmFjdG9yeSkge1xyXG4gICAgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xyXG4gICAgICAgIGRlZmluZShbJ2pxdWVyeSddLCBmYWN0b3J5KTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShyZXF1aXJlKFwianF1ZXJ5XCIpKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIGZhY3RvcnkoalF1ZXJ5KTtcclxuICAgIH1cclxufVxyXG4oZnVuY3Rpb24oJCkge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgdmFyIHBsdWdpbk5hbWUgPSBcInRpbnlzY3JvbGxiYXJcIlxyXG4gICAgLCAgIGRlZmF1bHRzID0ge1xyXG4gICAgICAgICAgICBheGlzIDogJ3knXHJcbiAgICAgICAgLCAgIHdoZWVsIDogdHJ1ZVxyXG4gICAgICAgICwgICB3aGVlbFNwZWVkIDogNDBcclxuICAgICAgICAsICAgd2hlZWxMb2NrIDogdHJ1ZVxyXG4gICAgICAgICwgICB0b3VjaExvY2sgOiB0cnVlXHJcbiAgICAgICAgLCAgIHRyYWNrU2l6ZSA6IGZhbHNlXHJcbiAgICAgICAgLCAgIHRodW1iU2l6ZSA6IGZhbHNlXHJcbiAgICAgICAgLCAgIHRodW1iU2l6ZU1pbiA6IDIwXHJcbiAgICAgICAgfVxyXG4gICAgO1xyXG5cclxuICAgIGZ1bmN0aW9uIFBsdWdpbigkY29udGFpbmVyLCBvcHRpb25zKSB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIG9wdGlvbnMgb2YgdGhlIGNhcm91c2VsIGV4dGVuZCB3aXRoIHRoZSBkZWZhdWx0cy5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwcm9wZXJ0eSBvcHRpb25zXHJcbiAgICAgICAgICogQHR5cGUgT2JqZWN0XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5vcHRpb25zID0gJC5leHRlbmQoe30sIGRlZmF1bHRzLCBvcHRpb25zKTtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQHByb3BlcnR5IF9kZWZhdWx0c1xyXG4gICAgICAgICAqIEB0eXBlIE9iamVjdFxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICogQGRlZmF1bHQgZGVmYXVsdHNcclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLl9kZWZhdWx0cyA9IGRlZmF1bHRzO1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAcHJvcGVydHkgX25hbWVcclxuICAgICAgICAgKiBAdHlwZSBTdHJpbmdcclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqIEBmaW5hbFxyXG4gICAgICAgICAqIEBkZWZhdWx0ICd0aW55c2Nyb2xsYmFyJ1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuX25hbWUgPSBwbHVnaW5OYW1lO1xyXG5cclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXNcclxuICAgICAgICAsICAgJHZpZXdwb3J0ID0gJGNvbnRhaW5lci5maW5kKFwiLnZpZXdwb3J0XCIpXHJcbiAgICAgICAgLCAgICRvdmVydmlldyA9ICRjb250YWluZXIuZmluZChcIi5vdmVydmlld1wiKVxyXG4gICAgICAgICwgICAkc2Nyb2xsYmFyID0gJGNvbnRhaW5lci5maW5kKFwiLnNjcm9sbGJhclwiKVxyXG4gICAgICAgICwgICAkdHJhY2sgPSAkc2Nyb2xsYmFyLmZpbmQoXCIudHJhY2tcIilcclxuICAgICAgICAsICAgJHRodW1iID0gJHNjcm9sbGJhci5maW5kKFwiLnRodW1iXCIpXHJcblxyXG4gICAgICAgICwgICBoYXNUb3VjaEV2ZW50cyA9IChcIm9udG91Y2hzdGFydFwiIGluIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudClcclxuICAgICAgICAsICAgd2hlZWxFdmVudCA9IFwib253aGVlbFwiIGluIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIikgPyBcIndoZWVsXCIgOiAvLyBNb2Rlcm4gYnJvd3NlcnMgc3VwcG9ydCBcIndoZWVsXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50Lm9ubW91c2V3aGVlbCAhPT0gdW5kZWZpbmVkID8gXCJtb3VzZXdoZWVsXCIgOiAvLyBXZWJraXQgYW5kIElFIHN1cHBvcnQgYXQgbGVhc3QgXCJtb3VzZXdoZWVsXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgIFwiRE9NTW91c2VTY3JvbGxcIiAvLyBsZXQncyBhc3N1bWUgdGhhdCByZW1haW5pbmcgYnJvd3NlcnMgYXJlIG9sZGVyIEZpcmVmb3hcclxuICAgICAgICAsICAgaXNIb3Jpem9udGFsID0gdGhpcy5vcHRpb25zLmF4aXMgPT09ICd4J1xyXG4gICAgICAgICwgICBzaXplTGFiZWwgPSBpc0hvcml6b250YWwgPyBcIndpZHRoXCIgOiBcImhlaWdodFwiXHJcbiAgICAgICAgLCAgIHBvc2lMYWJlbCA9IGlzSG9yaXpvbnRhbCA/IFwibGVmdFwiIDogXCJ0b3BcIlxyXG5cclxuICAgICAgICAsICAgbW91c2VQb3NpdGlvbiA9IDBcclxuICAgICAgICA7XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoZSBwb3NpdGlvbiBvZiB0aGUgY29udGVudCByZWxhdGl2ZSB0byB0aGUgdmlld3BvcnQuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcHJvcGVydHkgY29udGVudFBvc2l0aW9uXHJcbiAgICAgICAgICogQHR5cGUgTnVtYmVyXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5jb250ZW50UG9zaXRpb24gPSAwO1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUaGUgaGVpZ2h0IG9yIHdpZHRoIG9mIHRoZSB2aWV3cG9ydC5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwcm9wZXJ0eSB2aWV3cG9ydFNpemVcclxuICAgICAgICAgKiBAdHlwZSBOdW1iZXJcclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLnZpZXdwb3J0U2l6ZSA9IDA7XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoZSBoZWlnaHQgb3Igd2lkdGggb2YgdGhlIGNvbnRlbnQuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcHJvcGVydHkgY29udGVudFNpemVcclxuICAgICAgICAgKiBAdHlwZSBOdW1iZXJcclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmNvbnRlbnRTaXplID0gMDtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIHJhdGlvIG9mIHRoZSBjb250ZW50IHNpemUgcmVsYXRpdmUgdG8gdGhlIHZpZXdwb3J0IHNpemUuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcHJvcGVydHkgY29udGVudFJhdGlvXHJcbiAgICAgICAgICogQHR5cGUgTnVtYmVyXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5jb250ZW50UmF0aW8gPSAwO1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUaGUgaGVpZ2h0IG9yIHdpZHRoIG9mIHRoZSBjb250ZW50LlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHByb3BlcnR5IHRyYWNrU2l6ZVxyXG4gICAgICAgICAqIEB0eXBlIE51bWJlclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMudHJhY2tTaXplID0gMDtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIHNpemUgb2YgdGhlIHRyYWNrIHJlbGF0aXZlIHRvIHRoZSBzaXplIG9mIHRoZSBjb250ZW50LlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHByb3BlcnR5IHRyYWNrUmF0aW9cclxuICAgICAgICAgKiBAdHlwZSBOdW1iZXJcclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLnRyYWNrUmF0aW8gPSAwO1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUaGUgaGVpZ2h0IG9yIHdpZHRoIG9mIHRoZSB0aHVtYi5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwcm9wZXJ0eSB0aHVtYlNpemVcclxuICAgICAgICAgKiBAdHlwZSBOdW1iZXJcclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLnRodW1iU2l6ZSA9IDA7XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoZSBwb3NpdGlvbiBvZiB0aGUgdGh1bWIgcmVsYXRpdmUgdG8gdGhlIHRyYWNrLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHByb3BlcnR5IHRodW1iUG9zaXRpb25cclxuICAgICAgICAgKiBAdHlwZSBOdW1iZXJcclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLnRodW1iUG9zaXRpb24gPSAwO1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBXaWxsIGJlIHRydWUgaWYgdGhlcmUgaXMgY29udGVudCB0byBzY3JvbGwuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcHJvcGVydHkgaGFzQ29udGVudFRvU3JvbGxcclxuICAgICAgICAgKiBAdHlwZSBCb29sZWFuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5oYXNDb250ZW50VG9Tcm9sbCA9IGZhbHNlO1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAbWV0aG9kIF9pbml0aWFsaXplXHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBmdW5jdGlvbiBfaW5pdGlhbGl6ZSgpIHtcclxuICAgICAgICAgICAgc2VsZi51cGRhdGUoKTtcclxuICAgICAgICAgICAgX3NldEV2ZW50cygpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHNlbGY7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBZb3UgY2FuIHVzZSB0aGUgdXBkYXRlIG1ldGhvZCB0byBhZGp1c3QgdGhlIHNjcm9sbGJhciB0byBuZXcgY29udGVudCBvciB0byBtb3ZlIHRoZSBzY3JvbGxiYXIgdG8gYSBjZXJ0YWluIHBvaW50LlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQG1ldGhvZCB1cGRhdGVcclxuICAgICAgICAgKiBAY2hhaW5hYmxlXHJcbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ8U3RyaW5nfSBbc2Nyb2xsVG9dIE51bWJlciBpbiBwaXhlbHMgb3IgdGhlIHZhbHVlcyBcInJlbGF0aXZlXCIgb3IgXCJib3R0b21cIi4gSWYgeW91IGRvbnQgc3BlY2lmeSBhIHBhcmFtZXRlciBpdCB3aWxsIGRlZmF1bHQgdG8gdG9wXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy51cGRhdGUgPSBmdW5jdGlvbihzY3JvbGxUbykge1xyXG4gICAgICAgICAgICB2YXIgc2l6ZUxhYmVsQ2FwID0gc2l6ZUxhYmVsLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgc2l6ZUxhYmVsLnNsaWNlKDEpLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgICAgIHRoaXMudmlld3BvcnRTaXplID0gJHZpZXdwb3J0WzBdWydvZmZzZXQnKyBzaXplTGFiZWxDYXBdO1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRlbnRTaXplID0gJG92ZXJ2aWV3WzBdWydzY3JvbGwnKyBzaXplTGFiZWxDYXBdO1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRlbnRSYXRpbyA9IHRoaXMudmlld3BvcnRTaXplIC8gdGhpcy5jb250ZW50U2l6ZTtcclxuICAgICAgICAgICAgdGhpcy50cmFja1NpemUgPSB0aGlzLm9wdGlvbnMudHJhY2tTaXplIHx8IHRoaXMudmlld3BvcnRTaXplO1xyXG4gICAgICAgICAgICB0aGlzLnRodW1iU2l6ZSA9IE1hdGgubWluKHRoaXMudHJhY2tTaXplLCBNYXRoLm1heCh0aGlzLm9wdGlvbnMudGh1bWJTaXplTWluLCAodGhpcy5vcHRpb25zLnRodW1iU2l6ZSB8fCAodGhpcy50cmFja1NpemUgKiB0aGlzLmNvbnRlbnRSYXRpbykpKSwxKTtcclxuICAgICAgICAgICAgdGhpcy50cmFja1JhdGlvID0gKHRoaXMuY29udGVudFNpemUgLSB0aGlzLnZpZXdwb3J0U2l6ZSkgLyAodGhpcy50cmFja1NpemUgLSB0aGlzLnRodW1iU2l6ZSk7XHJcbiAgICAgICAgICAgIHRoaXMuaGFzQ29udGVudFRvU3JvbGwgPSB0aGlzLmNvbnRlbnRSYXRpbyA8IDE7XHJcblxyXG4gICAgICAgICAgICAkc2Nyb2xsYmFyLnRvZ2dsZUNsYXNzKFwiZGlzYWJsZVwiLCAhdGhpcy5oYXNDb250ZW50VG9Tcm9sbCk7XHJcblxyXG4gICAgICAgICAgICBzd2l0Y2ggKHNjcm9sbFRvKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiYm90dG9tXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb250ZW50UG9zaXRpb24gPSBNYXRoLm1heCh0aGlzLmNvbnRlbnRTaXplIC0gdGhpcy52aWV3cG9ydFNpemUsIDApO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgXCJyZWxhdGl2ZVwiOlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGVudFBvc2l0aW9uID0gTWF0aC5taW4oTWF0aC5tYXgodGhpcy5jb250ZW50U2l6ZSAtIHRoaXMudmlld3BvcnRTaXplLCAwKSwgTWF0aC5tYXgoMCwgdGhpcy5jb250ZW50UG9zaXRpb24pKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGVudFBvc2l0aW9uID0gcGFyc2VJbnQoc2Nyb2xsVG8sIDEwKSB8fCAwO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLnRodW1iUG9zaXRpb24gPSB0aGlzLmNvbnRlbnRQb3NpdGlvbiAvIHRoaXMudHJhY2tSYXRpbztcclxuXHJcbiAgICAgICAgICAgIF9zZXRDc3MoKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBzZWxmO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBtZXRob2QgX3NldENzc1xyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZnVuY3Rpb24gX3NldENzcygpIHtcclxuICAgICAgICAgICAgJHRodW1iLmNzcyhwb3NpTGFiZWwsIHNlbGYudGh1bWJQb3NpdGlvbik7XHJcbiAgICAgICAgICAgICRvdmVydmlldy5jc3MocG9zaUxhYmVsLCAtc2VsZi5jb250ZW50UG9zaXRpb24pO1xyXG4gICAgICAgICAgICAkc2Nyb2xsYmFyLmNzcyhzaXplTGFiZWwsIHNlbGYudHJhY2tTaXplKTtcclxuICAgICAgICAgICAgJHRyYWNrLmNzcyhzaXplTGFiZWwsIHNlbGYudHJhY2tTaXplKTtcclxuICAgICAgICAgICAgJHRodW1iLmNzcyhzaXplTGFiZWwsIHNlbGYudGh1bWJTaXplKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBtZXRob2QgX3NldEV2ZW50c1xyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZnVuY3Rpb24gX3NldEV2ZW50cygpIHtcclxuICAgICAgICAgICAgaWYoaGFzVG91Y2hFdmVudHMpIHtcclxuICAgICAgICAgICAgICAgICR2aWV3cG9ydFswXS5vbnRvdWNoc3RhcnQgPSBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKDEgPT09IGV2ZW50LnRvdWNoZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgX3N0YXJ0KGV2ZW50LnRvdWNoZXNbMF0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgJHRodW1iLmJpbmQoXCJtb3VzZWRvd25cIiwgZnVuY3Rpb24oZXZlbnQpe1xyXG4gICAgICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICBfc3RhcnQoZXZlbnQpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgJHRyYWNrLmJpbmQoXCJtb3VzZWRvd25cIiwgZnVuY3Rpb24oZXZlbnQpe1xyXG4gICAgICAgICAgICAgICAgX3N0YXJ0KGV2ZW50LCB0cnVlKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAkKHdpbmRvdykucmVzaXplKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi51cGRhdGUoXCJyZWxhdGl2ZVwiKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZihzZWxmLm9wdGlvbnMud2hlZWwgJiYgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIpIHtcclxuICAgICAgICAgICAgICAgICRjb250YWluZXJbMF0uYWRkRXZlbnRMaXN0ZW5lcih3aGVlbEV2ZW50LCBfd2hlZWwsIGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmKHNlbGYub3B0aW9ucy53aGVlbCkge1xyXG4gICAgICAgICAgICAgICAgJGNvbnRhaW5lclswXS5vbm1vdXNld2hlZWwgPSBfd2hlZWw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBtZXRob2QgX2lzQXRCZWdpblxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZnVuY3Rpb24gX2lzQXRCZWdpbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHNlbGYuY29udGVudFBvc2l0aW9uID4gMDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBtZXRob2QgX2lzQXRFbmRcclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIF9pc0F0RW5kKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gc2VsZi5jb250ZW50UG9zaXRpb24gPD0gKHNlbGYuY29udGVudFNpemUgLSBzZWxmLnZpZXdwb3J0U2l6ZSkgLSA1O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQG1ldGhvZCBfc3RhcnRcclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIF9zdGFydChldmVudCwgZ290b01vdXNlKSB7XHJcbiAgICAgICAgICAgIGlmKHNlbGYuaGFzQ29udGVudFRvU3JvbGwpIHtcclxuICAgICAgICAgICAgICAgICQoXCJib2R5XCIpLmFkZENsYXNzKFwibm9TZWxlY3RcIik7XHJcblxyXG4gICAgICAgICAgICAgICAgbW91c2VQb3NpdGlvbiA9IGdvdG9Nb3VzZSA/ICR0aHVtYi5vZmZzZXQoKVtwb3NpTGFiZWxdIDogKGlzSG9yaXpvbnRhbCA/IGV2ZW50LnBhZ2VYIDogZXZlbnQucGFnZVkpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKGhhc1RvdWNoRXZlbnRzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQub250b3VjaG1vdmUgPSBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihzZWxmLm9wdGlvbnMudG91Y2hMb2NrIHx8IF9pc0F0QmVnaW4oKSAmJiBfaXNBdEVuZCgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnRvdWNoZXNbMF1bcGx1Z2luTmFtZSArIFwiVG91Y2hcIl0gPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfZHJhZyhldmVudC50b3VjaGVzWzBdKTtcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50Lm9udG91Y2hlbmQgPSBfZW5kO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJChkb2N1bWVudCkuYmluZChcIm1vdXNlbW92ZVwiLCBfZHJhZyk7XHJcbiAgICAgICAgICAgICAgICAkKGRvY3VtZW50KS5iaW5kKFwibW91c2V1cFwiLCBfZW5kKTtcclxuICAgICAgICAgICAgICAgICR0aHVtYi5iaW5kKFwibW91c2V1cFwiLCBfZW5kKTtcclxuICAgICAgICAgICAgICAgICR0cmFjay5iaW5kKFwibW91c2V1cFwiLCBfZW5kKTtcclxuXHJcbiAgICAgICAgICAgICAgICBfZHJhZyhldmVudCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBtZXRob2QgX3doZWVsXHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBmdW5jdGlvbiBfd2hlZWwoZXZlbnQpIHtcclxuICAgICAgICAgICAgaWYoc2VsZi5oYXNDb250ZW50VG9Tcm9sbCkge1xyXG4gICAgICAgICAgICAgICAgLy8gVHJ5aW5nIHRvIG1ha2Ugc2Vuc2Ugb2YgYWxsIHRoZSBkaWZmZXJlbnQgd2hlZWwgZXZlbnQgaW1wbGVtZW50YXRpb25zLi5cclxuICAgICAgICAgICAgICAgIC8vXHJcbiAgICAgICAgICAgICAgICB2YXIgZXZudE9iaiA9IGV2ZW50IHx8IHdpbmRvdy5ldmVudFxyXG4gICAgICAgICAgICAgICAgLCAgIHdoZWVsRGVsdGEgPSAtKGV2bnRPYmouZGVsdGFZIHx8IGV2bnRPYmouZGV0YWlsIHx8ICgtMSAvIDMgKiBldm50T2JqLndoZWVsRGVsdGEpKSAvIDQwXHJcbiAgICAgICAgICAgICAgICAsICAgbXVsdGlwbHkgPSAoZXZudE9iai5kZWx0YU1vZGUgPT09IDEpID8gc2VsZi5vcHRpb25zLndoZWVsU3BlZWQgOiAxXHJcbiAgICAgICAgICAgICAgICA7XHJcblxyXG4gICAgICAgICAgICAgICAgc2VsZi5jb250ZW50UG9zaXRpb24gLT0gd2hlZWxEZWx0YSAqIG11bHRpcGx5ICogc2VsZi5vcHRpb25zLndoZWVsU3BlZWQ7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmNvbnRlbnRQb3NpdGlvbiA9IE1hdGgubWluKChzZWxmLmNvbnRlbnRTaXplIC0gc2VsZi52aWV3cG9ydFNpemUpLCBNYXRoLm1heCgwLCBzZWxmLmNvbnRlbnRQb3NpdGlvbikpO1xyXG4gICAgICAgICAgICAgICAgc2VsZi50aHVtYlBvc2l0aW9uID0gc2VsZi5jb250ZW50UG9zaXRpb24gLyBzZWxmLnRyYWNrUmF0aW87XHJcblxyXG4gICAgICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAgICAgKiBUaGUgbW92ZSBldmVudCB3aWxsIHRyaWdnZXIgd2hlbiB0aGUgY2Fyb3VzZWwgc2xpZGVzIHRvIGEgbmV3IHNsaWRlLlxyXG4gICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAqIEBldmVudCBtb3ZlXHJcbiAgICAgICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgICAgICRjb250YWluZXIudHJpZ2dlcihcIm1vdmVcIik7XHJcblxyXG4gICAgICAgICAgICAgICAgJHRodW1iLmNzcyhwb3NpTGFiZWwsIHNlbGYudGh1bWJQb3NpdGlvbik7XHJcbiAgICAgICAgICAgICAgICAkb3ZlcnZpZXcuY3NzKHBvc2lMYWJlbCwgLXNlbGYuY29udGVudFBvc2l0aW9uKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZihzZWxmLm9wdGlvbnMud2hlZWxMb2NrIHx8IF9pc0F0QmVnaW4oKSAmJiBfaXNBdEVuZCgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXZudE9iaiA9ICQuZXZlbnQuZml4KGV2bnRPYmopO1xyXG4gICAgICAgICAgICAgICAgICAgIGV2bnRPYmoucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBtZXRob2QgX2RyYWdcclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIF9kcmFnKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGlmKHNlbGYuaGFzQ29udGVudFRvU3JvbGwpIHtcclxuICAgICAgICAgICAgICAgIHZhciBtb3VzZVBvc2l0aW9uTmV3ID0gaXNIb3Jpem9udGFsID8gZXZlbnQucGFnZVggOiBldmVudC5wYWdlWVxyXG4gICAgICAgICAgICAgICAgLCAgIHRodW1iUG9zaXRpb25EZWx0YSA9IGV2ZW50W3BsdWdpbk5hbWUgKyBcIlRvdWNoXCJdID8gXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChtb3VzZVBvc2l0aW9uIC0gbW91c2VQb3NpdGlvbk5ldykgOiAobW91c2VQb3NpdGlvbk5ldyAtIG1vdXNlUG9zaXRpb24pXHJcbiAgICAgICAgICAgICAgICAsICAgdGh1bWJQb3NpdGlvbk5ldyA9IE1hdGgubWluKChzZWxmLnRyYWNrU2l6ZSAtIHNlbGYudGh1bWJTaXplKSwgTWF0aC5tYXgoMCwgc2VsZi50aHVtYlBvc2l0aW9uICsgdGh1bWJQb3NpdGlvbkRlbHRhKSlcclxuICAgICAgICAgICAgICAgIDtcclxuXHJcbiAgICAgICAgICAgICAgICBzZWxmLmNvbnRlbnRQb3NpdGlvbiA9IHRodW1iUG9zaXRpb25OZXcgKiBzZWxmLnRyYWNrUmF0aW87XHJcblxyXG4gICAgICAgICAgICAgICAgJGNvbnRhaW5lci50cmlnZ2VyKFwibW92ZVwiKTtcclxuXHJcbiAgICAgICAgICAgICAgICAkdGh1bWIuY3NzKHBvc2lMYWJlbCwgdGh1bWJQb3NpdGlvbk5ldyk7XHJcbiAgICAgICAgICAgICAgICAkb3ZlcnZpZXcuY3NzKHBvc2lMYWJlbCwgLXNlbGYuY29udGVudFBvc2l0aW9uKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQG1ldGhvZCBfZW5kXHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBmdW5jdGlvbiBfZW5kKCkge1xyXG4gICAgICAgICAgICBzZWxmLnRodW1iUG9zaXRpb24gPSBwYXJzZUludCgkdGh1bWIuY3NzKHBvc2lMYWJlbCksIDEwKSB8fCAwO1xyXG5cclxuICAgICAgICAgICAgJChcImJvZHlcIikucmVtb3ZlQ2xhc3MoXCJub1NlbGVjdFwiKTtcclxuICAgICAgICAgICAgJChkb2N1bWVudCkudW5iaW5kKFwibW91c2Vtb3ZlXCIsIF9kcmFnKTtcclxuICAgICAgICAgICAgJChkb2N1bWVudCkudW5iaW5kKFwibW91c2V1cFwiLCBfZW5kKTtcclxuICAgICAgICAgICAgJHRodW1iLnVuYmluZChcIm1vdXNldXBcIiwgX2VuZCk7XHJcbiAgICAgICAgICAgICR0cmFjay51bmJpbmQoXCJtb3VzZXVwXCIsIF9lbmQpO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5vbnRvdWNobW92ZSA9IGRvY3VtZW50Lm9udG91Y2hlbmQgPSBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIF9pbml0aWFsaXplKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAqIEBjbGFzcyB0aW55c2Nyb2xsYmFyXHJcbiAgICAqIEBjb25zdHJ1Y3RvclxyXG4gICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9uc1xyXG4gICAgICAgIEBwYXJhbSB7U3RyaW5nfSBbb3B0aW9ucy5heGlzPSd5J10gVmVydGljYWwgb3IgaG9yaXpvbnRhbCBzY3JvbGxlcj8gKCB4IHx8IHkgKS5cclxuICAgICAgICBAcGFyYW0ge0Jvb2xlYW59IFtvcHRpb25zLndoZWVsPXRydWVdIEVuYWJsZSBvciBkaXNhYmxlIHRoZSBtb3VzZXdoZWVsLlxyXG4gICAgICAgIEBwYXJhbSB7Qm9vbGVhbn0gW29wdGlvbnMud2hlZWxTcGVlZD00MF0gSG93IG1hbnkgcGl4ZWxzIG11c3QgdGhlIG1vdXN3aGVlbCBzY3JvbGwgYXQgYSB0aW1lLlxyXG4gICAgICAgIEBwYXJhbSB7Qm9vbGVhbn0gW29wdGlvbnMud2hlZWxMb2NrPXRydWVdIExvY2sgZGVmYXVsdCB3aW5kb3cgd2hlZWwgc2Nyb2xsaW5nIHdoZW4gdGhlcmUgaXMgbm8gbW9yZSBjb250ZW50IHRvIHNjcm9sbC5cclxuICAgICAgICBAcGFyYW0ge051bWJlcn0gW29wdGlvbnMudG91Y2hMb2NrPXRydWVdIExvY2sgZGVmYXVsdCB3aW5kb3cgdG91Y2ggc2Nyb2xsaW5nIHdoZW4gdGhlcmUgaXMgbm8gbW9yZSBjb250ZW50IHRvIHNjcm9sbC5cclxuICAgICAgICBAcGFyYW0ge0Jvb2xlYW58TnVtYmVyfSBbb3B0aW9ucy50cmFja1NpemU9ZmFsc2VdIFNldCB0aGUgc2l6ZSBvZiB0aGUgc2Nyb2xsYmFyIHRvIGF1dG8oZmFsc2UpIG9yIGEgZml4ZWQgbnVtYmVyLlxyXG4gICAgICAgIEBwYXJhbSB7Qm9vbGVhbnxOdW1iZXJ9IFtvcHRpb25zLnRodW1iU2l6ZT1mYWxzZV0gU2V0IHRoZSBzaXplIG9mIHRoZSB0aHVtYiB0byBhdXRvKGZhbHNlKSBvciBhIGZpeGVkIG51bWJlclxyXG4gICAgICAgIEBwYXJhbSB7Qm9vbGVhbn0gW29wdGlvbnMudGh1bWJTaXplTWluPTIwXSBNaW5pbXVtIHRodW1iIHNpemUuXHJcbiAgICAqL1xyXG4gICAgJC5mbltwbHVnaW5OYW1lXSA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZighJC5kYXRhKHRoaXMsIFwicGx1Z2luX1wiICsgcGx1Z2luTmFtZSkpIHtcclxuICAgICAgICAgICAgICAgICQuZGF0YSh0aGlzLCBcInBsdWdpbl9cIiArIHBsdWdpbk5hbWUsIG5ldyBQbHVnaW4oJCh0aGlzKSwgb3B0aW9ucykpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG59KSk7Il19
